# push-service

用于管理客户端 WebSocket 连接，维护用户在线状态，并将其他服务的消息推送给客户端。

## ✅ 功能模块

1. WebSocket 连接管理（单用户单连接，心跳保活）
2. 在线状态记录（内存+Redis）
3. 在线状态查询接口（gRPC，供其他服务调用）
4. 消息推送处理（判断在线状态，在线推送或离线存储）

## 🔐 鉴权机制

- 使用 JWT 校验用户身份
- 每次连接验证当前 session 是否为最新，若不是则断开连接

## 📤 消息推送流程

1. 接收其他服务发来的消息
2. 判断接收方是否在线：
   - 在线：通过 WebSocket 推送
   - 不在线或发送失败：存入 Redis 离线消息缓存
3. 用户上线后自动推送其离线消息
4. 接收客户端消息，发给对应的服务